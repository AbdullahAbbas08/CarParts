<!-- Car Parts Offers Section -->
<section class="car-parts-offers" [attr.aria-label]="'عروض قطع غيار السيارات'">
  <div class="container">
    
    <!-- Loading State -->
    <div *ngIf="isLoading" class="loading-skeleton">
      <div class="skeleton-card" *ngFor="let item of [1,2,3,4,5,6]">
        <div class="skeleton-image"></div>
        <div class="skeleton-content">
          <div class="skeleton-title"></div>
          <div class="skeleton-price"></div>
          <div class="skeleton-actions"></div>
        </div>
      </div>
    </div>

    <!-- Car Part Offers in Swiper -->
    <div class="offers-swiper-container" *ngIf="!isLoading">
      <div class="swiper offers-swiper">
        <div class="swiper-wrapper">
          <div class="swiper-slide" *ngFor="let offer of carPartOffers; trackBy: trackByOfferId">
            <article 
              class="car-part-card" 
              [attr.data-part-id]="offer.partId"
              [class.out-of-stock]="offer.isSold || offer.count === 0"
              role="button"
              tabindex="0"
              (click)="viewPartDetails(offer)"
              (keydown.enter)="viewPartDetails(offer)"
              (keydown.space)="viewPartDetails(offer)">

              <!-- Image Slider Section -->
              <div class="image-section">
                <div class="swiper image-swiper" *ngIf="offer.images && offer.images.length > 1">
                  <div class="swiper-wrapper">
                    <div class="swiper-slide" *ngFor="let image of offer.images; let i = index">
                      <img 
                        [src]="image" 
                        [alt]="offer.partName + ' - صورة ' + (i + 1)"
                        class="part-image"
                        loading="lazy"
                        (error)="onImageError($event)">
                    </div>
                  </div>
                </div>
                
                <!-- Single Image -->
                <div class="single-image" *ngIf="!offer.images || offer.images.length <= 1">
                  <img 
                    [src]="offer.images?.[0] || 'assets/images/placeholder-car-part.png'" 
                    [alt]="offer.partName"
                    class="part-image"
                    loading="lazy"
                    (error)="onImageError($event)">
                </div>
              </div>

              <!-- Card Content -->
              <div class="card-content">
                
                <!-- Wishlist Button -->
                <!-- <div class="wishlist-section">
                  <button 
                    class="wishlist-btn"
                    [class.active]="offer.isFavorite"
                    (click)="toggleWishlist(offer, $event)"
                    [attr.aria-label]="offer.isFavorite ? 'إزالة من المفضلة' : 'إضافة للمفضلة'"
                    type="button">
                    <i class="fas fa-heart" *ngIf="offer.isFavorite"></i>
                    <i class="far fa-heart" *ngIf="!offer.isFavorite"></i>
                  </button>
                </div> -->

                <!-- Part Name -->
                <h3 class="part-name" [title]="offer.partName">{{ offer.partName }}</h3>

                <!-- Badges Section -->
                <div class="badges-section">
                  <span class="condition-badge" [class]="'condition-' + offer.partCondition">
                    <i class="fas fa-certificate"></i>
                    {{ offer.conditionName }}
                  </span>
                  <span class="out-of-stock-badge" *ngIf="offer.isSold || offer.count === 0">
                    <i class="fas fa-exclamation-triangle"></i>
                    نفد المخزون
                  </span>
                  <span class="delivery-badge" *ngIf="offer.isDelivery">
                    <i class="fas fa-shipping-fast"></i>
                    توصيل سريع
                  </span>
                </div>

                <!-- Part Quality & Type -->
                <div class="part-meta">
                  <span class="meta-item quality">
                    <i class="fas fa-award" aria-hidden="true"></i>
                    <span>{{ offer.qualityName }}</span>
                  </span>
                  <span class="meta-item type">
                    <i class="fas fa-tag" aria-hidden="true"></i>
                    <span>{{ offer.partTypeName }}</span>
                  </span>
                </div>

                <!-- Price Section -->
                <div class="price-section">
                  <div class="price-row">
                    <span class="current-price">{{ formatPrice(offer.finalPrice) }}</span>
                    <span class="discount-badge" *ngIf="getDiscountPercentage(offer) > 0">
                      <i class="fas fa-tags"></i>
                      {{ getDiscountPercentage(offer) }}% خصم
                    </span>
                    <span class="old-price" *ngIf="offer.originalPrice > offer.finalPrice">{{ formatPrice(offer.originalPrice) }}</span>
                    <!-- <span class="savings" *ngIf="offer.originalPrice > offer.finalPrice">
                      وفر {{ formatPrice(offer.originalPrice - offer.finalPrice) }}
                    </span> -->
                  </div>
                </div>

                <!-- Stock Info -->
                <!-- <div class="stock-info" *ngIf="offer.count > 0 && !offer.isSold">
                  <i class="fas fa-box" aria-hidden="true"></i>
                  <span *ngIf="offer.count <= 5" class="low-stock">
                    متبقي {{ offer.count }} قطع فقط
                  </span>
                  <span *ngIf="offer.count > 5" class="in-stock">
                    متوفر في المخزون
                  </span>
                </div> -->

                <!-- Action Buttons -->
                <div class="action-buttons">
                  <button 
                    class="btn-details"
                    (click)="viewPartDetails(offer)"
                    [attr.aria-label]="'عرض تفاصيل ' + offer.partName"
                    type="button">
                    <i class="fas fa-info-circle" aria-hidden="true"></i>
                  </button>

                  <button 
                    class="btn-add-to-cart"
                    [disabled]="offer.isSold || offer.count === 0"
                    (click)="addToCart(offer, $event)"
                    [attr.aria-label]="'إضافة ' + offer.partName + ' للسلة'"
                    type="button">
                    <i class="fas fa-shopping-cart" aria-hidden="true"></i>
                    <span *ngIf="!offer.isSold && offer.count > 0">أضف للسلة</span>
                    <span *ngIf="offer.isSold || offer.count === 0">غير متوفر</span>
                  </button>
                </div>

              </div>
            </article>
          </div>
        </div>
      </div>
      
      <!-- Navigation -->
      <div class="swiper-button-prev offers-button-prev"></div>
      <div class="swiper-button-next offers-button-next"></div>
      
      <!-- Pagination -->
      <div class="swiper-pagination offers-pagination"></div>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!isLoading && carPartOffers.length === 0">
      <div class="empty-icon">
        <i class="fas fa-box-open"></i>
      </div>
      <h3>لا توجد عروض متاحة حالياً</h3>
      <p>تحقق مرة أخرى لاحقاً للحصول على أفضل العروض على قطع غيار السيارات</p>
    </div>

  </div>
</section>
